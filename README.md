# プロジェクトの概要

このプロジェクトは、画像に対するゼロショット分類を行い、その結果を評価し、F1 スコアを改善するためのラベルの選定を行うものです。主に`main.py`で全体のロジックが組み立てられており、その他のファイルではデータの可視化やラベルの類似度計算などの処理が行われています。

## `main.py`のロジックの流れ

1. 必要なライブラリや関数をインポートします。
2. `main`関数を定義し、その中で以下の処理を行います。
   - 特徴量数の宣言
   - F1 スコアとラベルの組み合わせを保存する辞書、平均 F1 スコアの履歴、改善したラベルの履歴を初期化
   - ラベルの初期選択
   - 現在の日時の取得
   - 100 回のイテレーションを行い、各イテレーションで以下の処理を実施
     - ゼロショット分類の実行
     - F1 スコアの計算
     - 平均 F1 スコアの計算と履歴への追加
     - F1 スコアが最も低いラベルの選定
     - ラベルの改善
     - 改善したラベルの履歴への追加
     - ラベルの初期化
   - F1 スコアの推移、平均 F1 スコアの推移、改善したラベルの番号の推移をファイルに保存
   - 最高の F1 スコアを持つラベル群と結果データを取得し、ログに出力

## 各ファイルの関数の説明

### `zero_shot_classification.py`

- `zero_shot_classification`関数は、画像 URL とラベルのリストを受け取り、ゼロショット分類を行い、結果を返します。

### `evaluate.py`

- `calculate_f1_scores`関数は、ゼロショット分類の結果データを受け取り、F1 スコアを計算します。
- `find_low_performance_labels_by_F1_score`関数は、F1 スコアが最も低いラベルを見つけ出します。

### `enhance_label_discrimination.py`

- `enhance_label_discrimination`関数は、F1 スコアが低いラベルを改善するために、ラベルの類似度を計算し、より区別しやすいラベルを選定します。

### `clip_distance.py`

- `calculate_similarity`関数は、ラベルのリストと画像 URL を受け取り、CLIP モデルを使用してラベルと画像の類似度を計算します。

### `show/f1_scores_show.py`と`show/avg_f1_score_show.py`

- これらのファイルには、F1 スコアの推移をグラフとして可視化するためのコードが含まれています。

### `show/zeroshot_result_show.py`

- `show`関数と`show_for_four_labels`関数は、ゼロショット分類の結果を可視化するために使用されます。

### `result_show_invoke.py`

- このファイルは、ゼロショット分類の結果を可視化するためのコードを含んでおり、`format_for_visualization`関数を使用してデータを整形した後、グラフを描画します。

## 実行方法

プロジェクトのルートディレクトリで以下のコマンドを実行します。

```
python main.py
```

## 依存関係

プロジェクトを実行するためには、以下のライブラリが必要です。

- torch
- clip
- Pillow
- requests
- matplotlib
- numpy

これらのライブラリは、`requirements.txt`にリストされており、以下のコマンドでインストールできます。

```
pip install -r requirements.txt
```
